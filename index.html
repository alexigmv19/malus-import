
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Simulateur Malus Import FR (CarAPI)</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        select, input, button { margin: 10px; padding: 10px; width: 250px; }
        #resultat { margin-top: 20px; font-weight: bold; color: red; }
    </style>
</head>
<body>
    <h1>Simulateur Malus Import FR (CarAPI)</h1>
    <label>Marque :</label>
    <select id="marque"><option>Chargement...</option></select>
    <br>
    <button onclick="testerChargement()">Tester API</button>
    <p id="resultat"></p>

    <script>
        async function chargerMarques() {
            const select = document.getElementById("marque");
            const resultat = document.getElementById("resultat");
            try {
                const response = await fetch("https://car-api2.p.rapidapi.com/api/makes", {
                    method: "GET",
                    headers: {
                        "x-rapidapi-host": "car-api2.p.rapidapi.com",
                        "x-rapidapi-key": "7|78K93fqqA0iT0DUL7v6IWMa9LEXxW5u3CKDFVtCb"
                    }
                });

                if (!response.ok) throw new Error("Réponse réseau incorrecte");

                const data = await response.json();
                select.innerHTML = "";
                if (data.data && data.data.length > 0) {
                    data.data.forEach(marque => {
                        const opt = document.createElement("option");
                        opt.value = marque.name;
                        opt.text = marque.name;
                        select.appendChild(opt);
                    });
                    resultat.textContent = "Marques chargées avec succès.";
                    resultat.style.color = "green";
                } else {
                    select.innerHTML = "<option>Aucune marque trouvée</option>";
                    resultat.textContent = "Aucune marque trouvée.";
                }
            } catch (error) {
                select.innerHTML = "<option>Erreur de chargement</option>";
                resultat.textContent = "Erreur : " + error.message;
            }
        }

        function testerChargement() {
            chargerMarques();
        }

        window.onload = chargerMarques;
    </script>
</body>
</html>
